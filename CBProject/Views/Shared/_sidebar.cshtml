@using Microsoft.AspNet.Identity
@using Microsoft.AspNet.Identity.EntityFramework
@using CBProject.Models





@{
    //var fullname = ((System.Security.Claims.ClaimsIdentity)User.Identity).FindFirst("FullName");
    //var user_image = ((System.Security.Claims.ClaimsIdentity)User.Identity).FindFirst("ImagePath");

    var context = new ApplicationDbContext();
    var userStore = new UserStore<ApplicationUser, ApplicationRole, string, IdentityUserLogin, IdentityUserRole, IdentityUserClaim>(context);
    var userManager = new CBProject.ApplicationUserManager(userStore);
    var currentUser = userManager.FindById(User.Identity.GetUserId());
    var roleStore = new RoleStore<ApplicationRole>(context);
    var roleManager = new RoleManager<ApplicationRole>(roleStore);


    var fullName = currentUser.FullName;
    var userImage = currentUser.ImagePath;


    RoleLevel access = RoleLevel.SUPERLOW;

    if (User.Identity.IsAuthenticated)
    {

        foreach (var role in currentUser.Roles)
        {
            var myRole = roleManager.FindById(role.RoleId);
            if (myRole.Level == RoleLevel.FULL)
            {
                access = myRole.Level;
            }
            else if (myRole.Level == RoleLevel.PLUSSFULL)
            {
                if (access != RoleLevel.FULL)
                {
                    access = myRole.Level;
                }
            }
            else if (myRole.Level == RoleLevel.MIDDLE)
            {
                if (access != RoleLevel.FULL &&
                    access != RoleLevel.PLUSSFULL)
                {
                    access = myRole.Level;
                }
            }
            else if (myRole.Level == RoleLevel.LOW)
            {
                if (access != RoleLevel.FULL &&
                    access != RoleLevel.PLUSSFULL &&
                    access != RoleLevel.MIDDLE)
                {
                    access = myRole.Level;
                }
            }
            else if (myRole.Level == RoleLevel.SUPERLOW)
            {
                if (access != RoleLevel.FULL &&
                    access != RoleLevel.PLUSSFULL &&
                    access != RoleLevel.MIDDLE &&
                    access != RoleLevel.LOW)
                {
                    access = myRole.Level;
                }
            }
        }
    }
}

@if (access == RoleLevel.FULL)
{
    <div class="vertical-menu">
        <div data-simplebar class="h-100">
            <div id="sidebar-menu">
                <ul class="metismenu list-unstyled" id="side-menu">
                    <hr />
                    <li class="menu-title" key="t-menu">
                        Menu
                    </li>
                    <hr style="background-color:darkblue;" />
                    <li>
                        <a href=@Url.Action("Index", "Home") key="t-home">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
                                <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
                            </svg>
                            Home
                        </a>
                    </li>
                    <li>
                        <a href=@Url.Action("Lessons", "Home") key="t-lessons">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book-half" viewBox="0 0 16 16">
                                <path d="M8.5 2.687c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z" />
                            </svg>
                            Lessons
                        </a>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-directions"></i>
                            <span class="badge rounded-pill bg-info float-end">3</span>
                            <span key="t-account">Account</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Users") key="t-users">Users</a></li>
                            <li><a href=@Url.Action("Index", "Roles") key="t-roles">Roles</a></li>
                            <li><a href=@Url.Action("Deleted", "Users") key="t-deleted-users">Deleted Users</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-user-circle"></i>
                            <span class="badge rounded-pill bg-info float-end">4</span>
                            <span key="t-actions">Actions</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Categories") key="t-categories">Categories</a></li>
                            <li><a href=@Url.Action("Index", "ContentTypes") key="t-content-types">ContentTypes</a></li>
                            <li><a href=@Url.Action("Index", "Payments") key="t-payments">Payments</a></li>
                            <li><a href=@Url.Action("Index", "SubscriptionPackages") key="t-subscription-packages">SubscriptionPackages</a></li>
                        </ul>
                    </li>

                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-photo-video"></i>
                            <span class="badge rounded-pill bg-info float-end">5</span>
                            <span key="t-contents">Contents</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Ratings") key="t-ratings">Ratings</a></li>
                            <li><a href=@Url.Action("Index", "Reviews") key="t-reviews">Reviews</a></li>
                            <li><a href=@Url.Action("Index", "Tags") key="t-tags">Tags</a></li>
                            <li><a href=@Url.Action("Index", "Videos") key="t-videos">Videos</a></li>
                            <li><a href=@Url.Action("Index", "Ebooks") key="t-ebooks">Ebooks</a></li>
                        </ul>
                    </li>

                    <hr style="margin-left: 3px; margin-right: 3px;" />
                </ul>
            </div>
        </div>
    </div>
}
@if (access == RoleLevel.PLUSSFULL)
{
    <div class="vertical-menu">
        <div data-simplebar class="h-100">
            <div id="sidebar-menu">
                <ul class="metismenu list-unstyled" id="side-menu">
                    <li class="menu-title" key="t-menu">Menu</li>
                    <li><a href=@Url.Action("Index", "Home") key="t-home">Home</a></li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-directions"></i>
                            <span class="badge rounded-pill bg-info float-end">3</span>
                            <span key="t-account">Account</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Users") key="t-users">Users</a></li>
                            <li><a href=@Url.Action("Index", "Roles") key="t-roles">Roles</a></li>
                            <li><a href=@Url.Action("Deleted", "Users") key="t-deleted-users">Deleted Users</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-user-circle"></i>
                            <span class="badge rounded-pill bg-info float-end">4</span>
                            <span key="t-actions">Actions</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Categories") key="t-categories">Categories</a></li>
                            <li><a href=@Url.Action("Index", "ContentTypes") key="t-content-types">ContentTypes</a></li>
                            <li><a href=@Url.Action("Index", "Payments") key="t-payments">Payments</a></li>
                            <li><a href=@Url.Action("Index", "SubscriptionPackages") key="t-subscription-packages">SubscriptionPackages</a></li>
                        </ul>
                    </li>

                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-photo-video"></i>
                            <span class="badge rounded-pill bg-info float-end">5</span>
                            <span key="t-contents">Contents</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Ratings") key="t-ratings">Ratings</a></li>
                            <li><a href=@Url.Action("Index", "Reviews") key="t-reviews">Reviews</a></li>
                            <li><a href=@Url.Action("Index", "Tags") key="t-tags">Tags</a></li>
                            <li><a href=@Url.Action("Index", "Videos") key="t-videos">Videos</a></li>
                            <li><a href=@Url.Action("Index", "Ebooks") key="t-ebooks">Ebooks</a></li>
                        </ul>
                    </li>

                    <hr style="margin-left: 3px; margin-right: 3px;" />
                </ul>
            </div>
        </div>
    </div>
}
@if (access == RoleLevel.MIDDLE)
{
    <div class="vertical-menu">
        <div data-simplebar class="h-100">
            <div id="sidebar-menu">
                <ul class="metismenu list-unstyled" id="side-menu">
                    <li class="menu-title" key="t-menu">Menu</li>
                    <li><a href=@Url.Action("Index", "Home") key="t-home">Home</a></li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-user-circle"></i>
                            <span class="badge rounded-pill bg-info float-end">2</span>
                            <span key="t-actions">Actions</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Categories") key="t-categories">Categories</a></li>
                            <li><a href=@Url.Action("Index", "ContentTypes") key="t-content-types">ContentTypes</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript: void(0);" class="waves-effect">
                            <i class="fas fa-photo-video"></i>
                            <span class="badge rounded-pill bg-info float-end">2</span>
                            <span key="t-contents">Contents</span>
                        </a>
                        <ul class="sub-menu" aria-expanded="false">
                            <li><a href=@Url.Action("Index", "Videos") key="t-videos">Videos</a></li>
                            <li><a href=@Url.Action("Index", "Ebooks") key="t-ebooks">Ebooks</a></li>
                        </ul>
                    </li>
                    <hr style="margin-left: 3px; margin-right: 3px;" />
                </ul>
            </div>
        </div>
    </div>
}
@if (access == RoleLevel.LOW)
{
    <div class="vertical-menu">
        <div data-simplebar class="h-100">
            <div id="sidebar-menu">
                <ul class="metismenu list-unstyled" id="side-menu">
                    <li class="menu-title" key="t-menu">Menu</li>
                    <li><a href=@Url.Action("Index", "Home") key="t-home">Home</a></li>
                    <li><a href=@Url.Action("Index", "Videos") key="t-videos">Videos</a></li>
                    <li><a href=@Url.Action("Index", "Ebooks") key="t-ebooks">Ebooks</a></li>
                    <hr style="margin-left: 3px; margin-right: 3px;" />
                </ul>
            </div>
        </div>
    </div>
}
@if (access == RoleLevel.SUPERLOW)
{
    <div class="vertical-menu">
        <div data-simplebar class="h-100">
            <div id="sidebar-menu">
                <ul class="metismenu list-unstyled" id="side-menu">
                    <li class="menu-title" key="t-menu">Menu</li>
                    <li><a href=@Url.Action("Index", "Home") key="t-home">Home</a></li>
                    <li><a href=@Url.Action("Index", "Videos") key="t-videos">Videos</a></li>
                    <li><a href=@Url.Action("Index", "Ebooks") key="t-ebooks">Ebooks</a></li>
                    <hr style="margin-left: 3px; margin-right: 3px;" />
                </ul>
            </div>
        </div>
    </div>
}

